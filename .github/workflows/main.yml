name: update
on:
  push:
    branches: [ main ]   
  schedule:
    - cron: '0 20 * * 2'

  # Allows you to run this workf

  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel

jobs:

  # This workflow contains a single job called "build"

  build:

    # The type of runner that the job will run on

    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job

    steps:

      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it

      - name: Checkout

        uses: actions/checkout@v2

      # Runs a single command using the runners shell

      - name: 'Set up Python'

        uses: actions/setup-python@v1

        with:

           python-version: 3.7

      - name: 'Install requirements'

        run: pip install wget
             pip install bs4
        
      - name: 'Working'

        run: 

          python main.py

      # git 提交文件

      - name: Commit files

        run: |

          git pull

          git config --local user.email "hyh20060327@qq.com"

          git config --local user.name "RavelloH"

          git add .

          git commit -m "`date '+%Y-%m-%d %H:%M:%S'`" #动态提交信息

        env:

          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # 推送到github仓库

      - name: Push changes

        uses: ad-m/github-push-action@master

        with:

          github_token: ${{ secrets.GITHUB_TOKEN }}

          branch: ${{ github.ref }}
